<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>صلوات شمار پیشرفته</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    :root {
      --primary-color: #5D3FD3;
      --secondary-color: #3A1CA6;
      --accent-color: #FF6B6B;
      --light-color: #F8F9FA;
      --dark-color: #2C3E50;
      --gold-color: #FFD700;
      --silver-color: #C0C0C0;
      --bronze-color: #CD7F32;
    }
    
    * {
      box-sizing: border-box;
    }
    
    body {
      margin: 0;
      font-family: "Vazir", sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #e6e9f0 100%);
      color: var(--dark-color);
      text-align: center;
      padding: 0 15px;
      min-height: 100vh;
      -webkit-tap-highlight-color: transparent;
    }

    header {
      background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
      color: white;
      padding: 15px 10px;
      border-radius: 0 0 20px 20px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }

    .header-title {
      font-size: 1.2rem;
      margin: 0;
    }

    .zekr {
      font-size: 0.9rem;
      margin: 8px 0 0;
      color: rgba(255,255,255,0.9);
    }

    .main-container {
      display: flex;
      flex-direction: column;
      max-width: 800px;
      margin: 0 auto;
      gap: 20px;
      padding-bottom: 30px;
    }

    .main-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
      background-color: white;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.08);
    }

    .user-greeting {
      font-size: 1.2rem;
      color: var(--secondary-color);
      margin-bottom: 5px;
    }

    .circle-btn {
      width: 180px;
      height: 180px;
      border-radius: 50%;
      background: white;
      box-shadow: 0 10px 25px rgba(93, 63, 211, 0.2);
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 5px solid var(--primary-color);
      overflow: hidden;
      position: relative;
    }

    @media (max-width: 480px) {
      .circle-btn {
        width: 150px;
        height: 150px;
      }
    }

    .circle-btn:hover {
      transform: scale(1.03);
      box-shadow: 0 15px 30px rgba(93, 63, 211, 0.3);
    }

    .circle-btn:active {
      transform: scale(0.98);
    }

    .circle-btn img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 50%;
    }

    .counter-text {
      font-size: 1.3rem;
      color: var(--secondary-color);
      font-weight: bold;
      margin-top: 10px;
    }

    .action-buttons {
      display: flex;
      justify-content: center;
      gap: 15px;
      width: 100%;
      margin-top: 15px;
    }

    .action-btn {
      background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
      color: white;
      padding: 12px 20px;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: bold;
      box-shadow: 0 5px 15px rgba(93, 63, 211, 0.2);
      border: none;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 1rem;
      flex: 1;
      justify-content: center;
      max-width: 200px;
    }

    .action-btn:active {
      transform: translateY(2px);
    }

    @font-face {
      font-family: "Vazir";
      src: url("https://cdn.fontcdn.ir/Font/Persian/Vazir/Vazir.woff2") format("woff2");
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.03); }
      100% { transform: scale(1); }
    }
    
    .pulse {
      animation: pulse 1.5s infinite;
    }

    .medal-icon {
      font-size: 1rem;
    }

    .gold {
      color: var(--gold-color);
    }

    .silver {
      color: var(--silver-color);
    }

    .bronze {
      color: var(--bronze-color);
    }

    /* بهبود نمایش در موبایل */
    @media (max-width: 768px) {
      header {
        padding: 12px 8px;
        border-radius: 0 0 15px 15px;
      }
      
      .header-title {
        font-size: 1rem;
      }
      
      .zekr {
        font-size: 0.8rem;
      }
      
      .main-content {
        padding: 15px;
      }
      
      .user-greeting {
        font-size: 1.1rem;
      }
      
      .counter-text {
        font-size: 1.1rem;
      }
      
      .action-btn {
        padding: 10px 15px;
        font-size: 0.9rem;
      }
    }

    @media (max-width: 480px) {
      .action-buttons {
        flex-direction: column;
        align-items: center;
      }
      
      .action-btn {
        max-width: 100%;
        width: 100%;
      }
    }
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>

  <header>
    <h1 class="header-title">ذکر روز <span id="weekday-name"></span>: <span id="today-zekr"></span></h1>
    <div class="zekr">تاریخ امروز: <span id="today-date"></span></div>
  </header>

  <div class="main-container">
    <div class="main-content">
      <div class="user-greeting">سلام <span id="username"></span>! 👋</div>
      
      <div class="circle-btn pulse" onclick="increase()" id="salavat-btn">
        <img src="Salavat.png" alt="صلوات">
      </div>
      
      <div class="counter-text">تعداد صلوات شما: <span id="count">0</span></div>
      
      <div class="action-buttons">
        <button class="action-btn" onclick="showPrayerBook()">
          <i class="fas fa-book-open"></i>
          <span>کتاب ادعیه</span>
        </button>
        <button class="action-btn" onclick="showLeaderboard()">
          <i class="fas fa-trophy"></i>
          <span>نفرات برتر</span>
        </button>
      </div>
    </div>
  </div>

  <script>
    // تنظیم تاریخ و ذکر روز
    function setupDateTime() {
      const zekrHaft = [
        "یا رب العالمین", "یا ذالجلال و الاکرام", "یا قاضی الحاجات",
        "یا ارحم الراحمین", "یا حی یا قیوم", "یا ارحم الراحمین", "اللهم صل علی محمد و آل محمد"
      ];
      const weekdays = ["شنبه", "یک‌شنبه", "دوشنبه", "سه‌شنبه", "چهارشنبه", "پنج‌شنبه", "جمعه"];
      const today = new Date();
      const jsDay = today.getDay();
      const weekDay = (jsDay + 1) % 7;

      document.getElementById('today-zekr').textContent = zekrHaft[weekDay];
      document.getElementById('weekday-name').textContent = weekdays[weekDay];
      
      // نمایش تاریخ به صورت کامل
      const persianDate = new Intl.DateTimeFormat('fa-IR-u-nu-latn', { 
        year: 'numeric',
        month: 'long',
        day: 'numeric',
        weekday: 'long'
      }).format(today);
      
      document.getElementById('today-date').textContent = persianDate;
    }

    // مدیریت نام کاربر
    function setupUsername() {
      let name = localStorage.getItem('username');
      if (!name) {
        Swal.fire({
          title: 'سلام دوست عزیز!',
          text: 'لطفاً نام خود را وارد کنید:',
          input: 'text',
          inputPlaceholder: 'نام شما...',
          background: '#f8f9fa',
          confirmButtonColor: '#5D3FD3',
          showCancelButton: false,
          allowOutsideClick: false,
          inputValidator: (value) => {
            if (!value) {
              return 'لطفاً نام خود را وارد کنید!';
            }
          }
        }).then((result) => {
          if (result.value) {
            name = result.value;
            localStorage.setItem('username', name);
            document.getElementById('username').textContent = name;
          }
        });
      } else {
        document.getElementById('username').textContent = name;
      }
    }

    // مدیریت صلوات شمار
    function setupSalavatCounter() {
      let count = parseInt(localStorage.getItem('salavatCount')) || 0;
      document.getElementById('count').textContent = count;
      let isPlaying = false;

      window.increase = function() {
        if (isPlaying) return;

        isPlaying = true;
        const btn = document.getElementById("salavat-btn");
        btn.classList.remove("pulse");
        btn.style.opacity = "0.7";
        btn.style.transform = "scale(0.95)";

        const salawatText = "اللهم صل علی محمد و آل محمد";
        let i = 0;
        let typedText = "";
        
        Swal.fire({
          title: 'صلوات',
          html: `<div id="typing-text" style="font-size: 1.3rem; color: #5D3FD3; min-height: 80px; line-height: 2;"></div>`,
          showConfirmButton: false,
          allowOutsideClick: false,
          background: '#f8f9fa',
          didOpen: () => {
            const typingInterval = setInterval(() => {
              if (i < salawatText.length) {
                typedText += salawatText.charAt(i);
                document.getElementById("typing-text").innerHTML = typedText;
                i++;
              } else {
                clearInterval(typingInterval);
                setTimeout(() => {
                  Swal.close();
                  completeSalawat();
                }, 500);
              }
            }, 100);
          }
        });

        function completeSalawat() {
          count++;
          localStorage.setItem('salavatCount', count);
          document.getElementById('count').textContent = count;

          isPlaying = false;
          btn.style.opacity = "1";
          btn.style.transform = "scale(1)";
          btn.classList.add("pulse");
        }
      }
    }

    // مدیریت منوی ادعیه و لیست برترین‌ها
    function setupMenus() {
      let currentSurahIndex = 0;
      const surahs = [
        {
          title: "سوره حمد",
          text: "بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ\nالْحَمْدُ لِلَّهِ رَبِّ الْعَالَمِينَ\nالرَّحْمَٰنِ الرَّحِيمِ\nمَالِكِ يَوْمِ الدِّينِ\nإِيَّاكَ نَعْبُدُ وَإِيَّاكَ نَسْتَعِينُ\nاهْدِنَا الصِّرَاطَ الْمُسْتَقِيمَ\nصِرَاطَ الَّذِينَ أَنْعَمْتَ عَلَيْهِمْ غَيْرِ الْمَغْضُوبِ عَلَيْهِمْ وَلَا الضَّالِّينَ"
        },
        {
          title: "سوره توحید",
          text: "بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ\nقُلْ هُوَ اللَّهُ أَحَدٌ\nاللَّهُ الصَّمَدُ\nلَمْ يَلِدْ وَلَمْ يُولَدْ\nوَلَمْ يَكُنْ لَهُ كُفُوًا أَحَدٌ"
        },
        {
          title: "سوره کوثر",
          text: "بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ\nإِنَّا أَعْطَيْنَاكَ الْكَوْثَرَ\nفَصَلِّ لِرَبِّكَ وَانْحَرْ\nإِنَّ شَانِئَكَ هُوَ الْأَبْتَرُ"
        },
        {
          title: "آیت الکرسی",
          text: "اللَّهُ لاَ إِلَهَ إِلاَّ هُوَ الْحَيُّ الْقَيُّومُ لاَ تَأْخُذُهُ سِنَةٌ وَلاَ نَوْمٌ لَّهُ مَا فِي السَّمَاوَاتِ وَمَا فِي الأَرْضِ مَن ذَا الَّذِي يَشْفَعُ عِنْدَهُ إِلاَّ بِإِذْنِهِ يَعْلَمُ مَا بَيْنَ أَيْدِيهِمْ وَمَا خَلْفَهُمْ وَلاَ يُحِيطُونَ بِشَيْءٍ مِّنْ عِلْمِهِ إِلاَّ بِمَا شَاء وَسِعَ كُرْسِيُّهُ السَّمَاوَاتِ وَالأَرْضَ وَلاَ يَؤُودُهُ حِفْظُهُمَا وَهُوَ الْعَلِيُّ الْعَظِيمُ"
        }
      ];

      window.showPrayerBook = function() {
        Swal.fire({
          title: 'کتاب ادعیه',
          html: `
            <div style="display: flex; flex-direction: column; gap: 10px; margin-top: 20px;">
              <button onclick="showQuran()" style="
                background: linear-gradient(to right, #5D3FD3, #3A1CA6);
                color: white;
                padding: 12px;
                border-radius: 8px;
                border: none;
                cursor: pointer;
                font-weight: bold;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 8px;
              ">
                <i class="fas fa-quran"></i>
                قرائت قرآن
              </button>
              
              <button onclick="showFaraj()" style="
                background: linear-gradient(to right, #5D3FD3, #3A1CA6);
                color: white;
                padding: 12px;
                border-radius: 8px;
                border: none;
                cursor: pointer;
                font-weight: bold;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 8px;
              ">
                <i class="fas fa-hands-praying"></i>
                دعای فرج
              </button>
              
              <button onclick="showNadeh()" style="
                background: linear-gradient(to right, #5D3FD3, #3A1CA6);
                color: white;
                padding: 12px;
                border-radius: 8px;
                border: none;
                cursor: pointer;
                font-weight: bold;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 8px;
              ">
                <i class="fas fa-person-praying"></i>
                دعای ندبه
              </button>
              
              <button onclick="showAshura()" style="
                background: linear-gradient(to right, #5D3FD3, #3A1CA6);
                color: white;
                padding: 12px;
                border-radius: 8px;
                border: none;
                cursor: pointer;
                font-weight: bold;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 8px;
              ">
                <i class="fas fa-kaaba"></i>
                زیارت عاشورا
              </button>
            </div>
          `,
          showConfirmButton: false,
          background: '#f8f9fa',
          width: '90%'
        });
      }

      window.showLeaderboard = function() {
        Swal.fire({
          title: 'نفرات برتر',
          html: `
            <div style="text-align: right; margin-top: 20px;">
              <div style="
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 12px 15px;
                border-bottom: 1px solid rgba(0,0,0,0.05);
                background-color: rgba(255, 215, 0, 0.1);
                border-left: 3px solid gold;
                border-radius: 8px;
                margin-bottom: 8px;
              ">
                <span style="font-weight: bold; color: #3A1CA6;">1</span>
                <span style="flex-grow: 1; padding: 0 10px;">محمد</span>
                <span style="font-weight: bold; color: #5D3FD3;">120 صلوات</span>
              </div>
              
              <div style="
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 12px 15px;
                border-bottom: 1px solid rgba(0,0,0,0.05);
                background-color: rgba(192, 192, 192, 0.1);
                border-left: 3px solid silver;
                border-radius: 8px;
                margin-bottom: 8px;
              ">
                <span style="font-weight: bold; color: #3A1CA6;">2</span>
                <span style="flex-grow: 1; padding: 0 10px;">فاطمه</span>
                <span style="font-weight: bold; color: #5D3FD3;">95 صلوات</span>
              </div>
              
              <div style="
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 12px 15px;
                border-bottom: 1px solid rgba(0,0,0,0.05);
                background-color: rgba(205, 127, 50, 0.1);
                border-left: 3px solid #CD7F32;
                border-radius: 8px;
                margin-bottom: 8px;
              ">
                <span style="font-weight: bold; color: #3A1CA6;">3</span>
                <span style="flex-grow: 1; padding: 0 10px;">علی</span>
                <span style="font-weight: bold; color: #5D3FD3;">80 صلوات</span>
              </div>
              
              <div style="
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 12px 15px;
                border-bottom: 1px solid rgba(0,0,0,0.05);
                background-color: rgba(245, 245, 245, 0.5);
                border-radius: 8px;
                margin-bottom: 8px;
              ">
                <span style="font-weight: bold; color: #3A1CA6;">4</span>
                <span style="flex-grow: 1; padding: 0 10px;">زهرا</span>
                <span style="font-weight: bold; color: #5D3FD3;">65 صلوات</span>
              </div>
              
              <div style="
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 12px 15px;
                border-bottom: 1px solid rgba(0,0,0,0.05);
                background-color: rgba(245, 245, 245, 0.5);
                border-radius: 8px;
              ">
                <span style="font-weight: bold; color: #3A1CA6;">5</span>
                <span style="flex-grow: 1; padding: 0 10px;">حسین</span>
                <span style="font-weight: bold; color: #5D3FD3;">50 صلوات</span>
              </div>
            </div>
          `,
          showConfirmButton: false,
          background: '#f8f9fa',
          width: '90%'
        });
      }

      window.showQuran = function() {
        const surah = surahs[currentSurahIndex];
        typeTextInPopup(surah.title, surah.text);
        
        // تغییر سوره برای دفعه بعدی
        currentSurahIndex = (currentSurahIndex + 1) % surahs.length;
      }

      window.showFaraj = function() {
        const farajText = "اللَّهُمَّ كُنْ لِوَلِيِّكَ الْحُجَّةِ بْنِ الْحَسَنِ\nصَلَوَاتُكَ عَلَيْهِ وَعَلَى آبَائِهِ\nفِي هَذِهِ السَّاعَةِ وَفِي كُلِّ سَاعَةٍ\nوَلِيًّا وَحَافِظًا وَقَائِدًا وَنَاصِرًا\nوَدَلِيلًا وَعَيْناً حَتَّى تُسْكِنَهُ أَرْضَكَ طَوْعًا\nوَتُمَتِّعَهُ فِيهَا طَوِيلًا";
        typeTextInPopup("دعای فرج", farajText);
      }

      window.showNadeh = function() {
        const nadehText = "اللَّهُمَّ إِنِّي أَشْكُو إِلَيْكَ\nفَقْدَ نَبِيِّنَا صَلَوَاتُكَ عَلَيْهِ وَآلِهِ\nوَغَيْبَةَ وَلِيِّنَا\nوَكَثْرَةَ عَدُوِّنَا\nوَقِلَّةَ عَدَدِنَا\nوَشِدَّةَ الْفِتَنِ بِنَا\nوَتَظَاهُرَ الزَّمَانِ عَلَيْنَا";
        typeTextInPopup("دعای ندبه", nadehText);
      }

      window.showAshura = function() {
        Swal.fire({
          title: 'زیارت عاشورا',
          text: 'این بخش در حال ساخت می‌باشد',
          icon: 'info',
          confirmButtonColor: '#5D3FD3',
          confirmButtonText: 'متوجه شدم'
        });
      }

      function typeTextInPopup(title, text) {
        let i = 0;
        let typedText = "";
        
        Swal.fire({
          title: title,
          html: `<div id="typing-text" style="font-size: 1.1rem; color: #5D3FD3; min-height: 200px; text-align: right; line-height: 2.5; padding: 10px;"></div>`,
          showConfirmButton: true,
          confirmButtonText: 'بستن',
          confirmButtonColor: '#5D3FD3',
          background: '#f8f9fa',
          width: '90%',
          didOpen: () => {
            const typingInterval = setInterval(() => {
              if (i < text.length) {
                typedText += text.charAt(i);
                document.getElementById("typing-text").innerHTML = typedText.replace(/\n/g, '<br>');
                i++;
              } else {
                clearInterval(typingInterval);
              }
            }, 50);
          }
        });
      }
    }

    // راه اندازی تمام بخش‌ها
    document.addEventListener('DOMContentLoaded', function() {
      setupDateTime();
      setupUsername();
      setupSalavatCounter();
      setupMenus();
      
      // بهبود عملکرد تاچ در موبایل
      document.querySelectorAll('button').forEach(btn => {
        btn.addEventListener('touchstart', function() {
          this.style.transform = 'translateY(2px)';
        });
        btn.addEventListener('touchend', function() {
          this.style.transform = '';
        });
      });
    });
  </script>

</body>
</html>
